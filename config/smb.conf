[global]
# Basic Samba settings
workgroup = WORKGROUP
server string = SMB Prophylactic Bridge
netbios name = smb-prophylactic
server role = standalone server
security = user
map to guest = bad user

# Protocol settings - accept both SMB1 and SMB2+
server min protocol = NT1
server max protocol = SMB3

# Client settings for connecting to legacy server
client min protocol = CORE
client max protocol = NT1

# Performance and security optimizations
socket options = TCP_NODELAY IPTOS_LOWDELAY SO_RCVBUF=1048576 SO_SNDBUF=1048576
read raw = yes
write raw = yes
max xmit = 65535
deadtime = 15

# Logging configuration
log level = 2
log file = /var/log/samba/%m.log
max log size = 1000
syslog = 0

# Disable unnecessary services
load printers = no
printing = bsd
printcap name = /dev/null
disable spoolss = yes

# Guest access configuration
guest account = nobody
map to guest = bad user

# VFS objects for advanced features
vfs objects = shadow_copy2

# Share definitions
[bridge-share]
    path = /srv/smb-bridge
    browseable = yes
    read only = no
    guest ok = yes
    create mask = 0644
    directory mask = 0755
    force user = samba
    force group = samba
    
    # Performance settings
    strict locking = no
    oplocks = yes
    level2 oplocks = yes
    
    # Security settings
    inherit permissions = yes
    inherit acls = yes
    
    # Comment for identification
    comment = SMB Prophylactic Bridge Share